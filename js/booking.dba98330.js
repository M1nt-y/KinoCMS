"use strict";(self["webpackChunkkino_cms"]=self["webpackChunkkino_cms"]||[]).push([[862],{2542:function(e,i,t){t.d(i,{h:function(){return n}});var a=t(1020),s=t(36),l=t(7329);const n=(0,a.Q_)({id:"Main",state:()=>({isActive:!1,currentLanguage:{selected:"en",index:0}}),actions:{toggleMenu(){this.isActive=!this.isActive},async getBooking(e){const i=(0,s.JU)(l.db,"booking","event-"+e),t=await(0,s.QT)(i);return t.exists()?t.data():void 0},async updateBooking(e,i){const t=Object.assign({},i);await(0,s.pl)((0,s.JU)(l.db,"booking","event-"+e),t)}}})},685:function(e,i,t){t.d(i,{s:function(){return o}});t(7658);var a=t(1020),s=t(1294),l=t(7329),n=t(36);const o=(0,a.Q_)({id:"Movies",state:()=>({movieList:[],upcomingList:[],loading:!1,showModal:!1,showUpcomingModal:!1,uploaded:!1}),actions:{async getMovies(){this.movieList=[],this.loading=!0;const e=await(0,n.PL)((0,n.hJ)(l.db,"movies"));e.forEach((e=>{this.movieList.push({id:this.movieList.length,name:e.id,uploaded:!0,language:e.data().language,data:e.data().data,images:[{main:{name:e.data().data[0].main.name,image:null,url:e.data().data[0].main.url},gallery:[],deleted:[]},{main:{name:e.data().data[1].main.name,image:null,url:e.data().data[1].main.url},gallery:[],deleted:[]}]})})),this.movieList.forEach((e=>{for(let i=0;i<e.data.length;i++)for(let t=0;t<e.data[i].gallery.length;t++)e.images[i].gallery.push({id:e.images[i].gallery.length,name:e.data[i].gallery[t].name,uploaded:!0,image:null,url:e.data[i].gallery[t].url})})),this.loading=!1},addMovie(e){this.movieList.push(e)},async deleteMovie(e){if(this.showModal=!1,this.loading=!0,this.movieList[e].uploaded){await(0,n.oe)((0,n.JU)(l.db,"movies",this.movieList[e].name));for(let i=0;i<this.movieList[e].images.length;i++){if(null!==this.movieList[e].images[i].main.name){const t=(0,s.iH)(l.tO,"movies/main/"+this.movieList[e].images[i].main.name);await(0,s.oq)(t).catch((e=>{console.error(e)}))}if(0!==this.movieList[e].images[i].gallery.length)for(let t=0;t<this.movieList[e].images[i].gallery.length;t++){const a=(0,s.iH)(l.tO,"movies/gallery/"+this.movieList[e].images[i].gallery[t].name);await(0,s.oq)(a).catch((e=>{console.error(e)}))}if(0!==this.movieList[e].images[i].deleted.length)for(let t=0;t<this.movieList[e].images[i].deleted.length;t++){const a=(0,s.iH)(l.tO,"movies/gallery/"+this.movieList[e].images[i].deleted[t].name);await(0,s.oq)(a).catch((e=>{console.error(e)}))}}}this.movieList.splice(e,1);for(let i=0;i<this.movieList.length;i++)this.movieList[i].id!==i&&(this.movieList[i].id=i);this.loading=!1},async uploadMovie(e){this.loading=!0,this.uploaded=!1;for(let t=0;t<this.movieList[e].images.length;t++){if(null!==this.movieList[e].images[t].main.image)try{const i=(0,s.iH)(l.tO,"movies/main/"+this.movieList[e].images[t].main.name);await(0,s.KV)(i,this.movieList[e].images[t].main.image).then((async()=>{await(0,s.Jt)(i).then((i=>{this.movieList[e].data[t].main.url=i}))}))}catch(i){console.error("Error uploading image: ",i)}if(0!==this.movieList[e].images[t].deleted.length)for(let i=0;i<this.movieList[e].images[t].deleted.length;i++){const a=(0,s.iH)(l.tO,"movies/gallery/"+this.movieList[e].images[t].deleted[i]);await(0,s.oq)(a).then((()=>{this.movieList[e].images[t].deleted.splice(i,1)})).catch((e=>{console.error(e)}))}if(this.movieList[e].images[t].gallery.length)for(let a=0;a<this.movieList[e].images[t].gallery.length;a++)if(null!==this.movieList[e].images[t].gallery[a].image)try{const i=(0,s.iH)(l.tO,"movies/gallery/"+this.movieList[e].images[t].gallery[a].name);await(0,s.KV)(i,this.movieList[e].images[t].gallery[a].image).then((async()=>{await(0,s.Jt)(i).then((i=>{this.movieList[e].data[t].gallery[a].url=i}))}))}catch(i){console.error("Error uploading image: ",i)}}for(let t=0;t<this.movieList[e].data.length;t++)for(let i=0;i<this.movieList[e].data[t].gallery.length;i++)null!==this.movieList[e].data[t].gallery[i].url&&i===this.movieList[e].data[t].gallery.length-1&&t===this.movieList[e].data.length-1&&this.uploadMovieData(e)},async uploadMovieData(e){const i={language:this.movieList[e].language,data:this.movieList[e].data};await(0,n.pl)((0,n.JU)(l.db,"movies",this.movieList[e].name),i).then((()=>{this.loading=!1,this.uploaded=!0}))},async resetMovie(e){if(this.loading=!0,this.movieList[e].uploaded){for(let a=0;a<this.movieList[e].images.length;a++)this.movieList[e].images[a].main.name=null,this.movieList[e].images[a].main.image=null,this.movieList[e].images[a].main.url=null,this.movieList[e].images[a].gallery=[],this.movieList[e].images[a].deleted=[];const i=(0,n.JU)(l.db,"movies",this.movieList[e].name),t=await(0,n.QT)(i);if(t.exists()){this.movieList[e].data=t.data().data;for(let i=0;i<this.movieList[e].data.length;i++){this.movieList[e].images[i].main.name=this.movieList[e].data[i].main.name,this.movieList[e].images[i].main.url=this.movieList[e].data[i].main.url;for(let t=0;t<this.movieList[e].data[i].gallery.length;t++)this.movieList[e].images[i].gallery.push({id:this.movieList[e].data[i].gallery.length,name:this.movieList[e].data[i].gallery[t].name,uploaded:!0,image:null,url:this.movieList[e].data[i].gallery[t].url})}}}this.loading=!1},async getUpcoming(){this.upcomingList=[],this.loading=!0;const e=await(0,n.PL)((0,n.hJ)(l.db,"upcoming"));e.forEach((e=>{this.upcomingList.push({id:this.upcomingList.length,name:e.id,uploaded:!0,language:e.data().language,data:e.data().data,images:[{main:{name:e.data().data[0].main.name,image:null,url:e.data().data[0].main.url},gallery:[],deleted:[]},{main:{name:e.data().data[1].main.name,image:null,url:e.data().data[1].main.url},gallery:[],deleted:[]}]})})),this.upcomingList.forEach((e=>{for(let i=0;i<e.data.length;i++){for(let t=0;t<e.data[i].gallery.length;t++)e.images[i].gallery.push({id:e.images[i].gallery.length,name:e.data[i].gallery[t].name,uploaded:!0,image:null,url:e.data[i].gallery[t].url});"object"===typeof e.data[i].screeningDate&&(e.data[i].screeningDate=new Date(1e3*e.data[i].screeningDate.seconds))}})),this.loading=!1},addUpcoming(e){this.upcomingList.push(e)},async deleteUpcoming(e){if(this.showUpcomingModal=!1,this.loading=!0,this.upcomingList[e].uploaded){await(0,n.oe)((0,n.JU)(l.db,"upcoming",this.upcomingList[e].name));for(let i=0;i<this.upcomingList[e].images.length;i++){if(null!==this.upcomingList[e].images[i].main.name){const t=(0,s.iH)(l.tO,"upcoming/main/"+this.upcomingList[e].images[i].main.name);await(0,s.oq)(t).catch((e=>{console.error(e)}))}if(0!==this.upcomingList[e].images[i].gallery.length)for(let t=0;t<this.upcomingList[e].images[i].gallery.length;t++){const a=(0,s.iH)(l.tO,"upcoming/gallery/"+this.upcomingList[e].images[i].gallery[t].name);await(0,s.oq)(a).catch((e=>{console.error(e)}))}if(0!==this.upcomingList[e].images[i].deleted.length)for(let t=0;t<this.upcomingList[e].images[i].deleted.length;t++){const a=(0,s.iH)(l.tO,"upcoming/gallery/"+this.upcomingList[e].images[i].deleted[t].name);await(0,s.oq)(a).catch((e=>{console.error(e)}))}}}this.upcomingList.splice(e,1);for(let i=0;i<this.upcomingList.length;i++)this.upcomingList[i].id!==i&&(this.upcomingList[i].id=i);this.loading=!1},async uploadUpcoming(e){this.loading=!0,this.uploaded=!1;for(let t=0;t<this.upcomingList[e].images.length;t++){if(null!==this.upcomingList[e].images[t].main.image)try{const i=(0,s.iH)(l.tO,"upcoming/main/"+this.upcomingList[e].images[t].main.name);await(0,s.KV)(i,this.upcomingList[e].images[t].main.image).then((async()=>{await(0,s.Jt)(i).then((i=>{this.upcomingList[e].data[t].main.url=i}))}))}catch(i){console.error("Error uploading image: ",i)}if(0!==this.upcomingList[e].images[t].deleted.length)for(let i=0;i<this.upcomingList[e].images[t].deleted.length;i++){const a=(0,s.iH)(l.tO,"upcoming/gallery/"+this.upcomingList[e].images[t].deleted[i]);await(0,s.oq)(a).then((()=>{this.upcomingList[e].images[t].deleted.splice(i,1)})).catch((e=>{console.error(e)}))}for(let a=0;a<this.upcomingList[e].images[t].gallery.length;a++)if(null!==this.upcomingList[e].images[t].gallery[a].image)try{const i=(0,s.iH)(l.tO,"upcoming/gallery/"+this.upcomingList[e].images[t].gallery[a].name);await(0,s.KV)(i,this.upcomingList[e].images[t].gallery[a].image).then((async()=>{await(0,s.Jt)(i).then((i=>{this.upcomingList[e].data[t].gallery[a].url=i}))}))}catch(i){console.error("Error uploading image: ",i)}}for(let t=0;t<this.upcomingList[e].data.length;t++)for(let i=0;i<this.upcomingList[e].data[t].gallery.length;i++)null!==this.upcomingList[e].data[t].gallery[i].url&&i===this.upcomingList[e].data[t].gallery.length-1&&t===this.upcomingList[e].data.length-1&&this.uploadUpcomingData(e)},async uploadUpcomingData(e){const i={language:this.upcomingList[e].language,data:this.upcomingList[e].data};await(0,n.pl)((0,n.JU)(l.db,"upcoming",this.upcomingList[e].name),i).then((()=>{this.loading=!1,this.uploaded=!0}))},async resetUpcoming(e){if(this.loading=!0,this.upcomingList[e].uploaded){for(let a=0;a<this.upcomingList[e].images.length;a++)this.upcomingList[e].images[a].main.name=null,this.upcomingList[e].images[a].main.image=null,this.upcomingList[e].images[a].main.url=null,this.upcomingList[e].images[a].gallery=[],this.upcomingList[e].images[a].deleted=[];const i=(0,n.JU)(l.db,"upcoming",this.upcomingList[e].name),t=await(0,n.QT)(i);if(t.exists()){this.upcomingList[e].data=t.data().data;for(let i=0;i<this.upcomingList[e].data.length;i++){"object"===typeof this.upcomingList[e].data[i].date&&(this.upcomingList[e].data[i].date=new Date(1e3*this.upcomingList[e].data[i].date.seconds)),this.upcomingList[e].images[i].main.name=this.upcomingList[e].data[i].main.name,this.upcomingList[e].images[i].main.url=this.upcomingList[e].data[i].main.url;for(let t=0;t<this.upcomingList[e].data[i].gallery.length;t++)this.upcomingList[e].images[i].gallery.push({id:this.upcomingList[e].data[i].gallery.length,name:this.upcomingList[e].data[i].gallery[t].name,uploaded:!0,image:null,url:this.upcomingList[e].data[i].gallery[t].url})}}}this.loading=!1}}})},4323:function(e,i,t){t.d(i,{b:function(){return n}});t(7658);var a=t(1020),s=t(36),l=t(7329);const n=(0,a.Q_)({id:"Schedule",state:()=>({loading:!1,eventDate:null,selectedCinema:null,selectedHall:null,selectedMovie:null,moviePrice:null,scheduledEvents:[]}),actions:{async getSchedule(){this.loading=!0,this.scheduledEvents=[];const e=await(0,s.PL)((0,s.hJ)(l.db,"schedule"));e.forEach((e=>{this.scheduledEvents.push({id:this.scheduledEvents.length,name:e.id,title:e.data().title,start:e.data().start,end:e.data().end,selectedCinema:e.data().selectedCinema,selectedHall:e.data().selectedHall,selectedMovie:e.data().selectedMovie,moviePrice:e.data().moviePrice})}));for(let i=0;i<this.scheduledEvents.length;i++)"object"===typeof this.scheduledEvents[i].end&&(this.scheduledEvents[i].end=new Date(1e3*this.scheduledEvents[i].end.seconds));this.loading=!1},async deleteEvent(e){this.loading=!0,await(0,s.oe)((0,s.JU)(l.db,"schedule",this.scheduledEvents[e].name)),this.loading=!1},async uploadEvent(e){this.loading=!0;const i={title:`${this.scheduledEvents[e].selectedCinema} - ${this.scheduledEvents[e].selectedMovie}`,start:this.scheduledEvents[e].start,end:this.scheduledEvents[e].end,selectedCinema:this.scheduledEvents[e].selectedCinema,selectedHall:this.scheduledEvents[e].selectedHall,selectedMovie:this.scheduledEvents[e].selectedMovie,moviePrice:this.scheduledEvents[e].moviePrice};await(0,s.pl)((0,s.JU)(l.db,"schedule",this.scheduledEvents[e].name),i).then((()=>{this.loading=!1}))}}})},4921:function(e,i,t){t.r(i),t.d(i,{default:function(){return q}});t(7658);var a=t(3396),s=t(4870),l=t(7139),n=t(2542),o=t(4323),d=t(1887),g=t(685),m=t(9865);const c=e=>((0,a.dD)("data-v-926599a4"),e=e(),(0,a.Cn)(),e),u={class:"page"},h={key:0,class:"container"},r={class:"event"},v={class:"event__info"},p=["src"],L=c((()=>(0,a._)("div",{class:"page__ad-vert"},null,-1))),y={key:0,class:"event__booking"},f={class:"event__booking-showcase"},w={class:"event__booking-info"},_={class:"text"},b={class:"event__booking-order"},E=c((()=>(0,a._)("span",null,"Your order: ",-1))),k=c((()=>(0,a._)("div",{class:"event__booking-screen"},null,-1))),U={class:"event__booking-seats"},D={class:"seats"},S=["onClick"],H={key:1,class:"page__notfound"},M={class:"container"},C=c((()=>(0,a._)("h2",null,"Event not found",-1))),J={name:"BookingPage"};var x=Object.assign(J,{props:["id"],setup(e){const i=e,t=(0,s.iH)([]),c=(0,n.h)(),J=(0,o.b)(),x=(0,d.a)(),O=(0,g.s)(),P=(0,m.t)();J.getSchedule(),x.getCinemas(),O.getMovies(),(0,a.wF)((()=>{c.getBooking(i.id).then((e=>{if(e)t.value=Object.values(e);else for(let i=1;i<=9;i++){t.value.push([]);for(let e=1;e<=20;e++)t.value[i-1].push({id:e,type:"Available"})}}))}));const q=(0,a.Fl)((()=>{let e=null;return J.scheduledEvents.forEach(((t,a)=>{t.name.includes(i.id)&&(e=a)})),e})),z=(0,a.Fl)((()=>{let e=null;return null!==q.value&&O.movieList.forEach(((i,t)=>{i.data[0].title===J.scheduledEvents[q.value].selectedMovie&&(e=t)})),e})),B=(0,a.Fl)((()=>{let e=null;return null!==q.value&&x.cinemaList.forEach(((i,t)=>{i.data[0].title===J.scheduledEvents[q.value].selectedCinema&&(e=t)})),e})),j=(0,a.Fl)((()=>{let e=null;return null!==q.value&&x.cinemaList[B.value].halls.forEach(((i,t)=>{i.data[0].title===J.scheduledEvents[q.value].selectedHall&&(e=t)})),e}));function A(e){let i=new Date(e).getDate(),t=new Date(e).getMonth()+1,a=new Date(e).getFullYear(),s=new Date(e).getHours(),l=new Date(e).getMinutes();return i<10&&(i="0"+i),t<10&&(t="0"+t),i+"."+t+"."+a+", "+s+":"+l}const F=(0,s.iH)([{text:"Available",color:"#67C23A"},{text:"Selected",color:"#4080D6"},{text:"Booked",color:"#F1C40F"},{text:"Sold",color:"#E74C3C"}]);function K(e){let i=null;return F.value.forEach((t=>{e.type===t.text&&(i=t.color)})),i}const Q=(0,s.iH)(0),Y=(0,s.iH)(0);function T(e,i){"Available"===t.value[e-1][i-1].type?(t.value[e-1][i-1].type="Selected",Q.value++,Y.value+=J.scheduledEvents[q.value].moviePrice):"Selected"===t.value[e-1][i-1].type&&(t.value[e-1][i-1].type="Available",Q.value--,Y.value-=J.scheduledEvents[q.value].moviePrice),console.log(e,i)}function V(){t.value.forEach((e=>{e.forEach((e=>{"Selected"===e.type&&(e.type="Booked",e.email=P.currentUser.email)}))})),c.updateBooking(i.id,t.value)}function R(){t.value.forEach((e=>{e.forEach((e=>{"Selected"===e.type&&(e.type="Sold",e.email=P.currentUser.email)}))})),c.updateBooking(i.id,t.value)}return(e,i)=>{const n=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("div",u,[null!==(0,s.SU)(q)?((0,a.wg)(),(0,a.iD)("div",h,[(0,a._)("div",r,[(0,a._)("div",v,[null!==(0,s.SU)(z)?((0,a.wg)(),(0,a.iD)("img",{key:0,class:"event__info-img",src:(0,s.SU)(O).movieList[(0,s.SU)(z)].data[(0,s.SU)(c).currentLanguage.index].main.url,alt:""},null,8,p)):(0,a.kq)("",!0),L]),null!==(0,s.SU)(z)&&null!==(0,s.SU)(B)&&null!==(0,s.SU)(j)?((0,a.wg)(),(0,a.iD)("div",y,[(0,a._)("h2",null,(0,l.zw)((0,s.SU)(O).movieList[(0,s.SU)(z)].data[(0,s.SU)(c).currentLanguage.index].title),1),(0,a._)("div",f,[(0,a._)("div",w,[(0,a._)("p",null,(0,l.zw)(A((0,s.SU)(J).scheduledEvents[(0,s.SU)(q)].start)),1),(0,a._)("p",null,(0,l.zw)((0,s.SU)(x).cinemaList[(0,s.SU)(B)].halls[(0,s.SU)(j)].data[(0,s.SU)(c).currentLanguage.index].title),1),(0,a._)("p",null,"Price: "+(0,l.zw)((0,s.SU)(J).scheduledEvents[(0,s.SU)(q)].moviePrice),1)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(F.value,((e,i)=>((0,a.wg)(),(0,a.iD)("div",{class:"seat-example",key:i},[(0,a._)("div",{class:"seat",style:(0,l.j5)({backgroundColor:e.color})},null,4),(0,a._)("div",_,(0,l.zw)(e.text),1)])))),128)),(0,a._)("div",b,[E,(0,a._)("span",null,"Tickets: "+(0,l.zw)(Q.value),1),(0,a._)("span",null,"Price: "+(0,l.zw)(Y.value),1)])]),k,(0,a._)("div",U,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.value,((e,i)=>((0,a.wg)(),(0,a.iD)("div",{class:"row",key:i},[(0,a._)("p",null,"Row "+(0,l.zw)(i+1),1),(0,a._)("div",D,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"seat",key:e.id,style:(0,l.j5)({backgroundColor:K(e)}),onClick:t=>T(i+1,e.id)},[(0,a._)("p",null,(0,l.zw)(e.id),1)],12,S)))),128))])])))),128))]),(0,a._)("div",{class:"event__booking-buttons"},[(0,a._)("button",{class:"btn btn-outline-light btn-lg mr-3",onClick:V},"Reserve"),(0,a._)("button",{class:"btn btn-outline-success btn-lg",onClick:R},"Buy")])])):(0,a.kq)("",!0)])])):((0,a.wg)(),(0,a.iD)("div",H,[(0,a._)("div",M,[C,(0,a.Wm)(n,{to:"/schedule"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Go back ")])),_:1})])]))])}}}),O=t(89);const P=(0,O.Z)(x,[["__scopeId","data-v-926599a4"]]);var q=P}}]);
//# sourceMappingURL=booking.dba98330.js.map