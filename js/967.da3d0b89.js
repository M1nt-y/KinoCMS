"use strict";(self["webpackChunkkino_cms"]=self["webpackChunkkino_cms"]||[]).push([[967],{89:function(a,e){e.Z=(a,e)=>{const l=a.__vccOpts||a;for(const[i,t]of e)l[i]=t;return l}},1887:function(a,e,l){l.d(e,{a:function(){return h}});l(7658);var i=l(1020),t=l(36),s=l(7329),n=l(1294);const h=(0,i.Q_)({id:"Cinemas",state:()=>({cinemaList:[],loading:!1,showModal:!1,uploaded:!1}),actions:{async getCinemas(){this.loading=!0,this.cinemaList=[];const a=await(0,t.PL)((0,t.hJ)(s.db,"cinemas"));a.forEach((a=>{this.cinemaList.push({id:this.cinemaList.length,name:a.id,uploaded:!0,language:a.data().language,data:a.data().data,images:[{logo:{name:a.data().data[0].logo.name,image:null,url:a.data().data[0].logo.url,uploaded:!0},banner:{name:a.data().data[0].banner.name,image:null,url:a.data().data[0].banner.url,uploaded:!0},gallery:[],deleted:[]},{logo:{name:a.data().data[1].logo.name,image:null,url:a.data().data[1].logo.url,uploaded:!0},banner:{name:a.data().data[1].banner.name,image:null,url:a.data().data[1].banner.url,uploaded:!0},gallery:[],deleted:[]}],halls:a.data().halls,deletedHalls:[]})})),this.cinemaList.forEach((a=>{for(let e=0;e<a.data.length;e++)for(let l=0;l<a.data[e].gallery.length;l++)a.images[e].gallery.push({id:a.images[e].gallery.length,name:a.data[e].gallery[l].name,uploaded:!0,image:null,url:a.data[e].gallery[l].url});for(let e=0;e<a.halls.length;e++){a.halls[e].id=e,a.halls[e].uploaded=!0,a.halls[e].images=[{scheme:{name:a.halls[e].data[0].scheme.name,image:null,url:a.halls[e].data[0].scheme.url,uploaded:!0},banner:{name:a.halls[e].data[0].banner.name,image:null,url:a.halls[e].data[0].banner.url,uploaded:!0},gallery:[],deleted:[]},{scheme:{name:a.halls[e].data[1].scheme.name,image:null,url:a.halls[e].data[1].scheme.url,uploaded:!0},banner:{name:a.halls[e].data[1].banner.name,image:null,url:a.halls[e].data[1].banner.url,uploaded:!0},gallery:[],deleted:[]}];for(let l=0;l<a.halls[e].data.length;l++)for(let i=0;i<a.halls[e].data[l].gallery.length;i++)a.halls[e].images[l].gallery.push({id:a.halls[e].images[l].gallery.length,name:a.halls[e].data[l].gallery[i].name,uploaded:!0,image:null,url:a.halls[e].data[l].gallery[i].url})}})),this.loading=!1},async deleteCinema(a){if(this.showModal=!1,this.loading=!0,this.cinemaList[a].uploaded){await(0,t.oe)((0,t.JU)(s.db,"cinemas",this.cinemaList[a].name));for(let e=0;e<this.cinemaList[a].images.length;e++){if(null!==this.cinemaList[a].images[e].logo.name){const l=(0,n.iH)(s.tO,"cinemas/logo/"+this.cinemaList[a].images[e].logo.name);await(0,n.oq)(l).catch((a=>{console.error(a)}))}if(null!==this.cinemaList[a].images[e].banner.name){const l=(0,n.iH)(s.tO,"cinemas/banner/"+this.cinemaList[a].images[e].banner.name);await(0,n.oq)(l).catch((a=>{console.error(a)}))}if(0!==this.cinemaList[a].images[e].gallery.length)for(let l=0;l<this.cinemaList[a].images[e].gallery.length;l++){const i=(0,n.iH)(s.tO,"cinemas/gallery/"+this.cinemaList[a].images[e].gallery[l].name);await(0,n.oq)(i).catch((a=>{console.error(a)}))}if(0!==this.cinemaList[a].images[e].deleted.length)for(let l=0;l<this.cinemaList[a].images[e].deleted.length;l++){const i=(0,n.iH)(s.tO,"cinemas/gallery/"+this.cinemaList[a].images[e].deleted[l].name);await(0,n.oq)(i).catch((a=>{console.error(a)}))}}if(0!==this.cinemaList[a].halls.length)for(let e=0;e<this.cinemaList[a].halls.length;e++)for(let l=0;l<this.cinemaList[a].halls[e].images.length;l++){if(null!==this.cinemaList[a].halls[e].images[l].scheme.name){const i=(0,n.iH)(s.tO,"cinemas/halls/scheme/"+this.cinemaList[a].halls[e].images[l].scheme.name);await(0,n.oq)(i).catch((a=>{console.error(a)}))}if(null!==this.cinemaList[a].halls[e].images[l].banner.name){const i=(0,n.iH)(s.tO,"cinemas/halls/banner/"+this.cinemaList[a].halls[e].images[l].banner.name);await(0,n.oq)(i).catch((a=>{console.error(a)}))}if(0!==this.cinemaList[a].halls[e].images[l].gallery.length)for(let i=0;i<this.cinemaList[a].halls[e].images[l].gallery.length;i++){const t=(0,n.iH)(s.tO,"cinemas/halls/gallery/"+this.cinemaList[a].halls[e].images[l].gallery[i].name);await(0,n.oq)(t).catch((a=>{console.error(a)}))}if(0!==this.cinemaList[a].halls[e].images[l].deleted.length)for(let i=0;i<this.cinemaList[a].halls[e].images[l].deleted.length;i++){const t=(0,n.iH)(s.tO,"cinemas/halls/gallery/"+this.cinemaList[a].halls[e].images[l].deleted[i].name);await(0,n.oq)(t).catch((a=>{console.error(a)}))}}if(0!==this.cinemaList[a].deletedHalls.length)for(let e=0;e<this.cinemaList[a].deletedHalls.length;e++)for(let l=0;l<this.cinemaList[a].deletedHalls[e].images.length;l++){if(null!==this.cinemaList[a].deletedHalls[e].images[l].scheme.name){const i=(0,n.iH)(s.tO,"cinemas/halls/scheme/"+this.cinemaList[a].deletedHalls[e].images[l].scheme.name);await(0,n.oq)(i).catch((a=>{console.error(a)}))}if(null!==this.cinemaList[a].deletedHalls[e].images[l].banner.name){const i=(0,n.iH)(s.tO,"cinemas/halls/banner/"+this.cinemaList[a].deletedHalls[e].images[l].banner.name);await(0,n.oq)(i).catch((a=>{console.error(a)}))}if(0!==this.cinemaList[a].deletedHalls[e].images[l].gallery.length)for(let i=0;i<this.cinemaList[a].deletedHalls[e].images[l].gallery.length;i++){const t=(0,n.iH)(s.tO,"cinemas/halls/gallery/"+this.cinemaList[a].deletedHalls[e].images[l].gallery[i].name);await(0,n.oq)(t).catch((a=>{console.error(a)}))}if(0!==this.cinemaList[a].deletedHalls[e].images[l].deleted.length)for(let i=0;i<this.cinemaList[a].halls[e].images[l].deleted.length;i++){const t=(0,n.iH)(s.tO,"cinemas/halls/gallery/"+this.cinemaList[a].deletedHalls[e].images[l].deleted[i].name);await(0,n.oq)(t).catch((a=>{console.error(a)}))}}}this.cinemaList.splice(a,1);for(let e=0;e<this.cinemaList.length;e++)this.cinemaList[e].id!==e&&(this.cinemaList[e].id=e);this.loading=!1},async uploadCinema(a){if(this.loading=!0,this.uploaded=!1,0!==this.cinemaList[a].deletedHalls.length)for(let l=0;l<this.cinemaList[a].deletedHalls.length;l++){for(let e=0;e<this.cinemaList[a].deletedHalls[l].images.length;e++){if(null!==this.cinemaList[a].deletedHalls[l].images[e].scheme.name){const i=(0,n.iH)(s.tO,"cinemas/halls/scheme/"+this.cinemaList[a].deletedHalls[l].images[e].scheme.name);await(0,n.oq)(i).catch((a=>{console.error(a)}))}if(null!==this.cinemaList[a].deletedHalls[l].images[e].banner.name){const i=(0,n.iH)(s.tO,"cinemas/halls/banner/"+this.cinemaList[a].deletedHalls[l].images[e].banner.name);await(0,n.oq)(i).catch((a=>{console.error(a)}))}if(0!==this.cinemaList[a].deletedHalls[l].images[e].gallery.length)for(let i=0;i<this.cinemaList[a].deletedHalls[l].images[e].gallery.length;i++)if(null!==this.cinemaList[a].deletedHalls[l].images[e].gallery[i].name){const t=(0,n.iH)(s.tO,"cinemas/halls/gallery/"+this.cinemaList[a].deletedHalls[l].images[e].gallery[i].name);await(0,n.oq)(t).catch((a=>{console.error(a)}))}if(0!==this.cinemaList[a].deletedHalls[l].images[e].deleted.length)for(let i=0;i<this.cinemaList[a].deletedHalls[l].images[e].deleted.length;i++){const t=(0,n.iH)(s.tO,"cinemas/halls/gallery/"+this.cinemaList[a].deletedHalls[l].images[e].deleted[i]);await(0,n.oq)(t).catch((a=>{console.error(a)}))}}this.cinemaList[a].deletedHalls.splice(l,1)}for(let l=0;l<this.cinemaList[a].images.length;l++){if(null!==this.cinemaList[a].images[l].logo.image)try{const e=(0,n.iH)(s.tO,"cinemas/logo/"+this.cinemaList[a].images[l].logo.name);await(0,n.KV)(e,this.cinemaList[a].images[l].logo.image).then((async()=>{await(0,n.Jt)(e).then((e=>{this.cinemaList[a].data[l].logo.url=e}))}))}catch(e){console.error("Error uploading image: ",e)}if(null!==this.cinemaList[a].images[l].banner.image)try{const e=(0,n.iH)(s.tO,"cinemas/banner/"+this.cinemaList[a].images[l].banner.name);await(0,n.KV)(e,this.cinemaList[a].images[l].banner.image).then((async()=>{await(0,n.Jt)(e).then((e=>{this.cinemaList[a].data[l].banner.url=e}))}))}catch(e){console.error("Error uploading image: ",e)}if(0!==this.cinemaList[a].images[l].deleted.length)for(let e=0;e<this.cinemaList[a].images[l].deleted.length;e++){const i=(0,n.iH)(s.tO,"cinemas/gallery/"+this.cinemaList[a].images[l].deleted[e]);await(0,n.oq)(i).then((()=>{this.cinemaList[a].images[l].deleted.splice(e,1)})).catch((a=>{console.error(a)}))}for(let i=0;i<this.cinemaList[a].images[l].gallery.length;i++)if(null!==this.cinemaList[a].images[l].gallery[i].image)try{const e=(0,n.iH)(s.tO,"cinemas/gallery/"+this.cinemaList[a].images[l].gallery[i].name);await(0,n.KV)(e,this.cinemaList[a].images[l].gallery[i].image).then((async()=>{await(0,n.Jt)(e).then((e=>{this.cinemaList[a].data[l].gallery[i].url=e}))}))}catch(e){console.error("Error uploading image: ",e)}}for(let l=0;l<this.cinemaList[a].data.length;l++)for(let e=0;e<this.cinemaList[a].data[l].gallery.length;e++)null!==this.cinemaList[a].data[l].gallery[e].url&&e===this.cinemaList[a].data[l].gallery.length-1&&l===this.cinemaList[a].data.length-1&&this.uploadCinemaData(a)},async uploadCinemaData(a){const e={language:this.cinemaList[a].language,data:this.cinemaList[a].data,halls:[]};await(0,t.pl)((0,t.JU)(s.db,"cinemas",this.cinemaList[a].name),e).then((()=>{this.cinemaList[a].halls.length?this.uploadHalls(a):(this.loading=!1,this.uploaded=!0)}))},async uploadHalls(a){for(let l=0;l<this.cinemaList[a].halls.length;l++)for(let i=0;i<this.cinemaList[a].halls[l].images.length;i++){if(null!==this.cinemaList[a].halls[l].images[i].scheme.image)try{const e=(0,n.iH)(s.tO,"cinemas/halls/scheme/"+this.cinemaList[a].halls[l].images[i].scheme.name);await(0,n.KV)(e,this.cinemaList[a].halls[l].images[i].scheme.image).then((async()=>{await(0,n.Jt)(e).then((e=>{this.cinemaList[a].halls[l].data[i].scheme.url=e}))}))}catch(e){console.error("Error uploading image: ",e)}if(null!==this.cinemaList[a].halls[l].images[i].banner.image)try{const e=(0,n.iH)(s.tO,"cinemas/halls/banner/"+this.cinemaList[a].halls[l].images[i].banner.name);await(0,n.KV)(e,this.cinemaList[a].halls[l].images[i].banner.image).then((async()=>{await(0,n.Jt)(e).then((e=>{this.cinemaList[a].halls[l].data[i].banner.url=e}))}))}catch(e){console.error("Error uploading image: ",e)}if(0!==this.cinemaList[a].halls[l].images[i].deleted.length)for(let e=0;e<this.cinemaList[a].halls[l].images[i].deleted.length;e++){const t=(0,n.iH)(s.tO,"cinemas/halls/gallery/"+this.cinemaList[a].halls[l].images[i].deleted[e]);await(0,n.oq)(t).then((()=>{this.cinemaList[a].halls[l].images[i].deleted.splice(e,1)})).catch((a=>{console.error(a)}))}for(let t=0;t<this.cinemaList[a].halls[l].images[i].gallery.length;t++)if(null!==this.cinemaList[a].halls[l].images[i].gallery[t].image)try{const e=(0,n.iH)(s.tO,"cinemas/halls/gallery/"+this.cinemaList[a].halls[l].images[i].gallery[t].name);await(0,n.KV)(e,this.cinemaList[a].halls[l].images[i].gallery[t].image).then((async()=>{await(0,n.Jt)(e).then((e=>{this.cinemaList[a].halls[l].data[i].gallery[t].url=e}))}))}catch(e){console.error("Error uploading image: ",e)}}for(let l=0;l<this.cinemaList[a].halls.length;l++)for(let e=0;e<this.cinemaList[a].halls[l].data.length;e++)for(let i=0;i<this.cinemaList[a].halls[l].data[e].gallery.length;i++)l===this.cinemaList[a].halls.length-1&&e===this.cinemaList[a].halls[l].data.length-1&&i===this.cinemaList[a].halls[l].data[e].gallery.length-1&&this.uploadHallsData(a)},async uploadHallsData(a){const e=(0,t.JU)(s.db,"cinemas",this.cinemaList[a].name);for(let l=0;l<this.cinemaList[a].halls.length;l++){const i={name:this.cinemaList[a].halls[l].name,creationDate:this.cinemaList[a].halls[l].creationDate,data:this.cinemaList[a].halls[l].data};await(0,t.r7)(e,{halls:(0,t.vr)(i)}).then((()=>{l===this.cinemaList[a].halls.length-1&&(this.loading=!1,this.uploaded=!0)}))}}}})}}]);
//# sourceMappingURL=967.da3d0b89.js.map