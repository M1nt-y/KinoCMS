{"version":3,"file":"js/newsletter.f6c0145e.js","mappings":"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","sources":["webpack://kino-cms/./node_modules/vue-loader/dist/exportHelper.js","webpack://kino-cms/./src/stores/newsletter.js","webpack://kino-cms/./src/stores/users.js","webpack://kino-cms/./src/components/admin/DeleteModal.vue","webpack://kino-cms/./src/components/admin/DeleteModal.vue?f05d","webpack://kino-cms/./src/components/admin/TheLoading.vue","webpack://kino-cms/./src/components/admin/TheLoading.vue?187b","webpack://kino-cms/./src/pages/admin/AdminNewsletter.vue","webpack://kino-cms/./src/pages/admin/AdminNewsletter.vue?736d"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","import { defineStore } from 'pinia';\r\nimport { db, storage } from \"@/firebase/firebase\";\r\n// import {getDownloadURL, listAll, ref, uploadBytes} from \"firebase/storage\";\r\nimport {deleteObject, listAll, ref, uploadBytes} from \"firebase/storage\";\r\nimport {collection, deleteDoc, doc, getDocs, setDoc} from \"firebase/firestore\";\r\n\r\n\r\nexport const useNewsletterStore = defineStore({\r\n    id: 'Newsletter',\r\n    state: () => ({\r\n        loading: false,\r\n        showModal: false,\r\n        smsUsers: [],\r\n        emailUsers: [],\r\n        templateList: [],\r\n        smsPicked: '',\r\n        emailPicked: '',\r\n        templatePicked: ''\r\n    }),\r\n    actions: {\r\n        async getTemplates() {\r\n            this.loading = true;\r\n            this.templateList = [];\r\n            const templatesFile = ref(storage, 'templates');\r\n            const templatesData = await getDocs(collection(db, 'templates'));\r\n            // get templates data\r\n            templatesData.forEach((doc) => {\r\n                this.templateList.push({\r\n                    id: this.templateList.length,\r\n                    name: doc.id,\r\n                    uploaded: true,\r\n                    file: null,\r\n                    fileName: doc.data().fileName\r\n                });\r\n            });\r\n            listAll(templatesFile).then((res) => {\r\n                if (res.items.length !== 0) {\r\n                    res.items.forEach((itemRef) => {\r\n                        console.log(itemRef);\r\n                        // getDownloadURL(ref(storage, itemRef.fullPath))\r\n                        //     .then((url) => {\r\n                        //         for (let i = 0; i < this.templateList.length; i++) {\r\n                        //\r\n                        //         }\r\n                        //     })\r\n                    });\r\n                }\r\n            }).catch((error) => {\r\n                console.log(error);\r\n            });\r\n            this.loading = false;\r\n        },\r\n        async deleteTemplate(id) {\r\n            this.showModal = false;\r\n            this.loading = true;\r\n            if (this.templateList[id].fileName === this.templatePicked) {\r\n                this.templatePicked = '';\r\n            }\r\n            if (this.templateList[id].uploaded) {\r\n                // delete data\r\n                await deleteDoc(doc(db, \"templates\", this.templateList[id].name));\r\n                // delete file\r\n                const delRef = ref(storage, 'templates/' + this.templateList[id].name);\r\n                deleteObject(delRef).catch((error) => {\r\n                    console.error(error);\r\n                });\r\n            }\r\n            this.templateList.splice(id, 1);\r\n            for (let i = 0; i < this.templateList.length; i++) {\r\n                if (this.templateList[i].id !== i) {\r\n                    this.templateList[i].id = i;\r\n                }\r\n            }\r\n            this.loading = false;\r\n        },\r\n        async uploadTemplates() {\r\n            this.loading = true;\r\n            for (let i = 0; i < this.templateList.length; i++) {\r\n                if (this.templateList[i].file !== null) {\r\n                    // upload file\r\n                    try {\r\n                        const templatesRef = ref(storage, \"templates/\" + this.templateList[i].name);\r\n                        await uploadBytes(templatesRef, this.templateList[i].file);\r\n                    } catch (e) {\r\n                        console.error(\"Error uploading template: \", e);\r\n                    }\r\n                    // upload data\r\n                    await setDoc(doc(db, \"templates\", this.templateList[i].name), {\r\n                        fileName: this.templateList[i].fileName\r\n                    });\r\n                }\r\n            }\r\n            this.loading = false;\r\n        }\r\n    }\r\n})","import { defineStore } from 'pinia';\r\nimport { collection, deleteDoc, doc, getDocs, setDoc } from \"firebase/firestore\";\r\nimport { db, secondaryApp } from \"@/firebase/firebase\";\r\nimport {getAuth, updatePassword, updateEmail, deleteUser, signInWithEmailAndPassword} from \"firebase/auth\";\r\n\r\n\r\nexport const useUsersStore = defineStore({\r\n    id: \"Users\",\r\n    state: () => ({\r\n        loading: false,\r\n        showModal: false,\r\n        usersList: [],\r\n        uploaded: false,\r\n    }),\r\n    actions: {\r\n        async getUsers() {\r\n            this.loading = true;\r\n            this.usersList = [];\r\n            const usersData = await getDocs(collection(db, 'users'));\r\n            usersData.forEach((doc) => {\r\n                this.usersList.push({\r\n                    id: this.usersList.length,\r\n                    name: doc.id,\r\n                    email: doc.data().email,\r\n                    password: doc.data().password,\r\n                    username: doc.data().username,\r\n                    registrationDate: doc.data().registrationDate,\r\n                    fullName: doc.data().fullName,\r\n                    phone: doc.data().phone,\r\n                    creditCard: doc.data().creditCard,\r\n                    birthday: doc.data().birthday,\r\n                    city: doc.data().city,\r\n                    address: doc.data().address,\r\n                    gender: doc.data().gender,\r\n                    language: doc.data().language,\r\n                    emailChange: doc.data().email,\r\n                    passwordChange: '',\r\n                    passwordCheck: ''\r\n                })\r\n            });\r\n            for (let i = 0; i < this.usersList.length; i++) {\r\n                if (typeof this.usersList[i].birthday === 'object') {\r\n                    this.usersList[i].birthday = new Date(this.usersList[i].birthday.seconds*1000);\r\n                }\r\n            }\r\n            this.loading = false;\r\n        },\r\n        async deleteUser(id) {\r\n            this.showModal = false;\r\n            this.loading = true;\r\n            const auth = getAuth(secondaryApp);\r\n            signInWithEmailAndPassword(auth, this.usersList[id].email, this.usersList[id].password)\r\n                .then((userCredential) => {\r\n                    const user = userCredential.user;\r\n                    deleteUser(user).then(async () => {\r\n                        await deleteDoc(doc(db, \"users\", this.usersList[id].name));\r\n                        this.usersList.splice(id, 1);\r\n                        for (let i = 0; i < this.usersList.length; i++) {\r\n                            if (this.usersList[i].id !== i) {\r\n                                this.usersList[i].id = i;\r\n                            }\r\n                        }\r\n                    }).catch((e) => {\r\n                        console.log(e);\r\n                    });\r\n                })\r\n                .catch((error) => {\r\n                    console.log(error);\r\n                });\r\n            this.loading = false;\r\n        },\r\n        async saveUser(id) {\r\n            this.loading = true;\r\n            this.uploaded = false;\r\n            const auth = getAuth(secondaryApp);\r\n            signInWithEmailAndPassword(auth, this.usersList[id].email, this.usersList[id].password)\r\n                .then(async (userCredential) => {\r\n                    const user = userCredential.user;\r\n                    if (user.email !== this.usersList[id].emailChange) {\r\n                        this.usersList[id].email = this.usersList[id].emailChange;\r\n                        updateEmail(user, this.usersList[id].emailChange).catch((error) => {\r\n                            console.log(error);\r\n                        });\r\n                    }\r\n                    if (this.usersList[id].passwordChange !== '' && this.usersList[id].passwordChange === this.usersList[id].passwordCheck && this.usersList[id].password !== this.usersList[id].passwordChange) {\r\n                        this.usersList[id].password = this.usersList[id].passwordChange;\r\n                        updatePassword(user, this.usersList[id].password).catch((error) => {\r\n                            console.log(error);\r\n                        });\r\n                    }\r\n                    const userData = {\r\n                        email: this.usersList[id].email,\r\n                        password: this.usersList[id].password,\r\n                        username: this.usersList[id].username,\r\n                        registrationDate: this.usersList[id].registrationDate,\r\n                        fullName: this.usersList[id].fullName,\r\n                        phone: this.usersList[id].phone,\r\n                        creditCard: this.usersList[id].creditCard,\r\n                        birthday: this.usersList[id].birthday,\r\n                        city: this.usersList[id].city,\r\n                        address: this.usersList[id].address,\r\n                        gender: this.usersList[id].gender,\r\n                        language: this.usersList[id].language\r\n                    }\r\n                    await setDoc(doc(db, \"users\", this.usersList[id].name), userData).then(() => {\r\n                        this.uploaded = true;\r\n                    });\r\n                }).catch((error) => {\r\n                    console.log(error);\r\n                });\r\n            this.loading = false;\r\n        }\r\n    }\r\n})","<template>\r\n  <div class=\"modal-delete\" @click=\"$emit('closeModal')\">\r\n    <div class=\"modal-dialog\" @click.stop>\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h1>Confirm deletion</h1>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <h3>Are you sure you want to delete?</h3>\r\n        </div>\r\n        <div class=\"modal-footer justify-content-between\">\r\n          <button class=\"btn btn-default\" @click=\"$emit('closeModal')\">Cancel</button>\r\n          <button class=\"btn btn-danger\" @click=\"$emit('confirmDeletion')\">Confirm</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"DeleteModal\"\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.modal-delete {\r\n  top: 0;\r\n  left: 0;\r\n  z-index: 2023;\r\n  height: 100%;\r\n  width: 100%;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  position: absolute;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.modal-delete__content {\r\n  padding: 80px;\r\n  background-color: rgba(255, 255, 255, 0.9);\r\n}\r\n</style>","import { render } from \"./DeleteModal.vue?vue&type=template&id=2487a2fa&scoped=true\"\nimport script from \"./DeleteModal.vue?vue&type=script&lang=js\"\nexport * from \"./DeleteModal.vue?vue&type=script&lang=js\"\n\nimport \"./DeleteModal.vue?vue&type=style&index=0&id=2487a2fa&scoped=true&lang=css\"\n\nimport exportComponent from \"S:\\\\Projects\\\\kino-cms\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2487a2fa\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"loading\">\r\n    <span></span>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"TheLoading\"\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.loading {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  z-index: 2023;\r\n  height: 100vh;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  animation: spin;\r\n}\r\n@keyframes spin {\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n.loading span {\r\n  display: block;\r\n  width: 60px;\r\n  height: 60px;\r\n  margin: 0 auto;\r\n  border: 3px solid transparent;\r\n  border-top-color: #FFFFFF;\r\n  border-bottom-color: #FFFFFF;\r\n  border-radius: 50%;\r\n  animation: spin ease 1000ms infinite;\r\n}\r\n</style>","import { render } from \"./TheLoading.vue?vue&type=template&id=60e77b62&scoped=true\"\nimport script from \"./TheLoading.vue?vue&type=script&lang=js\"\nexport * from \"./TheLoading.vue?vue&type=script&lang=js\"\n\nimport \"./TheLoading.vue?vue&type=style&index=0&id=60e77b62&scoped=true&lang=css\"\n\nimport exportComponent from \"S:\\\\Projects\\\\kino-cms\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-60e77b62\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"newsletter\" >\r\n    <TheLoading v-show=\"newsletterStore.loading\" />\r\n    <DeleteModal\r\n        @confirmDeletion=\"newsletterStore.deleteTemplate(templateID)\"\r\n        @closeModal=\"newsletterStore.showModal = false\"\r\n        v-if=\"newsletterStore.showModal\"\r\n    />\r\n    <div class=\"newsletter__wrapper\">\r\n      <h2>SMS</h2>\r\n      <div class=\"newsletter__radio\">\r\n        <p>Choose</p>\r\n        <input type=\"radio\" id=\"smsAll\" value=\"All\" v-model=\"newsletterStore.smsPicked\" />\r\n        <label for=\"smsAll\">All users</label>\r\n        <input type=\"radio\" id=\"smsSelect\" value=\"Select\" v-model=\"newsletterStore.smsPicked\" />\r\n        <label for=\"smsSelect\">Selectively</label>\r\n        <router-link\r\n            :to=\"{\r\n              name: 'ChooseUsers',\r\n              params: {\r\n                id: 'sms',\r\n              }\r\n            }\"\r\n            v-if=\"newsletterStore.smsPicked === 'Select'\"\r\n        >\r\n          Select users\r\n        </router-link>\r\n      </div>\r\n      <div class=\"newsletter__content\">\r\n        <div class=\"newsletter__content-column\">\r\n          <div class=\"newsletter__content-item\">\r\n            <p>SMS text</p>\r\n            <p>Symbols: {{ characterCount }}</p>\r\n          </div>\r\n          <textarea\r\n              class=\"form-control\"\r\n              v-model=\"smsContent\"\r\n              :disabled=\"smsDisabled\"\r\n          />\r\n        </div>\r\n        <div class=\"newsletter__content-column\">\r\n          <p>SMS count: {{ smsCount }}</p>\r\n          <p>SMS sent: {{ smsSent }} ({{ smsPercentage }}%) </p>\r\n        </div>\r\n      </div>\r\n      <button class=\"btn btn-primary\" @click=\"sendSms\">Start</button>\r\n    </div>\r\n    <div class=\"newsletter__wrapper\">\r\n      <h2>Email</h2>\r\n      <div class=\"newsletter__radio\">\r\n        <p>Choose</p>\r\n        <input type=\"radio\" id=\"emailAll\" value=\"All\" v-model=\"newsletterStore.emailPicked\" />\r\n        <label for=\"emailAll\">All users</label>\r\n        <input type=\"radio\" id=\"emailSelect\" value=\"Select\" v-model=\"newsletterStore.emailPicked\" />\r\n        <label for=\"emailSelect\">Selectively</label>\r\n        <router-link\r\n            :to=\"{\r\n              name: 'ChooseUsers',\r\n              params: {\r\n                id: 'email',\r\n              }\r\n            }\"\r\n            v-if=\"newsletterStore.emailPicked === 'Select'\"\r\n        >\r\n          Select users\r\n        </router-link>\r\n      </div>\r\n      <div class=\"newsletter__content\">\r\n        <div class=\"newsletter__content-column\">\r\n          <label>\r\n            <span>Upload HTML letter</span>\r\n            <input class=\"newsletter__content-input\" type=\"file\" accept=\"text/html\" @change=\"templateSelected($event)\">\r\n          </label>\r\n          <p>Uploaded file: {{ fileName }}</p>\r\n          <p>Chosen template in current newsletter: {{ templateName }}</p>\r\n          <p>Emails count: {{ emailCount }}</p>\r\n          <p>Emails sent: {{ emailSent }} ({{ emailPercentage }}%)</p>\r\n        </div>\r\n        <div class=\"newsletter__content-column\">\r\n          <div class=\"newsletter__content-wrapper\">\r\n            <h5>List of latest uploaded newsletter templates</h5>\r\n            <div class=\"newsletter__content-templates\" v-if=\"newsletterStore.templateList.length>0\">\r\n              <div class=\"newsletter__content-template\" v-for=\"template in newsletterStore.templateList\" :key=\"template.id\">\r\n                <label>\r\n                  <input type=\"radio\" :value=\"template.name\" v-model=\"newsletterStore.templatePicked\">\r\n                  <span>{{ template.fileName }}</span>\r\n                </label>\r\n                <p @click=\"toggleModal(template.id)\">Delete</p>\r\n              </div>\r\n            </div>\r\n            <p v-else>No uploaded templates</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <button class=\"btn btn-primary\" @click=\"sendEmail\">Start</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {computed, ref} from \"vue\";\r\nimport {useUsersStore} from \"@/stores/users\";\r\nimport {useNewsletterStore} from \"@/stores/newsletter\";\r\nimport TheLoading from \"@/components/admin/TheLoading\";\r\nimport DeleteModal from \"@/components/admin/DeleteModal\";\r\n\r\n\r\nconst usersStore = useUsersStore();\r\nconst newsletterStore = useNewsletterStore();\r\nusersStore.getUsers();\r\nnewsletterStore.getTemplates();\r\n\r\n\r\nconst smsCount = computed(() => {\r\n  if (newsletterStore.smsPicked === 'All') {\r\n    return usersStore.usersList.length;\r\n  }\r\n  else {\r\n    return newsletterStore.smsUsers.length\r\n  }\r\n});\r\nconst smsContent = ref('');\r\nconst characterCount = computed(() => {\r\n  return smsContent.value.length;\r\n});\r\nconst smsSent = ref(0);\r\nconst smsPercentage = ref(0);\r\nconst smsDisabled = ref(false);\r\nasync function sendSms() {\r\n  if (smsCount.value !== 0 && smsContent.value !== '') {\r\n    smsSent.value = smsPercentage.value = 0;\r\n    smsDisabled.value = true;\r\n    for (let i = 0; i < smsCount.value; i++) {\r\n      smsSent.value++;\r\n      smsPercentage.value = Math.ceil(smsSent.value / smsCount.value * 100);\r\n      await new Promise(r => setTimeout(r, 100));\r\n    }\r\n    smsDisabled.value = false;\r\n  }\r\n}\r\n\r\nconst fileName = ref('');\r\nfunction templateSelected(input) {\r\n  let file = input.target.files[0];\r\n  fileName.value = file.name;\r\n  if (newsletterStore.templateList.length === 5) {\r\n    newsletterStore.deleteTemplate(0);\r\n  }\r\n  newsletterStore.templateList.push({\r\n    id: newsletterStore.templateList.length,\r\n    name: 'template-' + Date.now(),\r\n    uploaded: false,\r\n    fileName: file.name,\r\n    file: file\r\n  });\r\n}\r\n\r\nlet templateID = null;\r\nfunction toggleModal(id) {\r\n  newsletterStore.showModal = true;\r\n  templateID = id;\r\n}\r\n\r\nconst templateName = computed(() => {\r\n  let fileName = '';\r\n  if (newsletterStore.templatePicked !== '') {\r\n    newsletterStore.templateList.forEach((template) => {\r\n      if (template.name === newsletterStore.templatePicked) {\r\n        fileName = template.fileName\r\n      }\r\n    })\r\n  }\r\n  return fileName\r\n})\r\n\r\nconst emailCount = computed(() => {\r\n  if (newsletterStore.emailPicked === 'All') {\r\n    return usersStore.usersList.length;\r\n  }\r\n  else {\r\n    return newsletterStore.emailUsers.length;\r\n  }\r\n});\r\nconst emailSent = ref(0);\r\nconst emailPercentage = ref(0);\r\nasync function sendEmail() {\r\n  if (emailCount.value !== 0 && newsletterStore.emailPicked !== '') {\r\n    newsletterStore.uploadTemplates();\r\n    emailSent.value = emailPercentage.value = 0;\r\n    for (let i = 0; i < emailCount.value; i++) {\r\n      emailSent.value++;\r\n      emailPercentage.value = Math.ceil(emailSent.value / emailCount.value * 100);\r\n      await new Promise(r => setTimeout(r, 100));\r\n    }\r\n  }\r\n}\r\n\r\n\r\n</script>\r\n\r\n<script>\r\nexport default {\r\n  name: \"AdminNewsletter\",\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.newsletter {\r\n  padding: 40px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 20px;\r\n}\r\n.newsletter__wrapper {\r\n  width: 100%;\r\n  border: 1px solid #000000;\r\n  border-radius: 15px;\r\n  padding: 20px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 50px;\r\n}\r\n\r\n.newsletter__radio {\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n}\r\n\r\n.newsletter__content {\r\n  width: 100%;\r\n  display: flex;\r\n  gap: 20px;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n.newsletter__content-column {\r\n  width: 50%;\r\n}\r\n.newsletter__content-item {\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n.newsletter__content-wrapper {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  border: 1px solid #000000;\r\n  border-radius: 15px;\r\n  padding: 20px;\r\n  gap: 10px;\r\n}\r\n.newsletter__content-input {\r\n  display: none;\r\n}\r\n.newsletter__content-templates {\r\n  width: 100%;\r\n}\r\n.newsletter__content-template {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\np, label {\r\n  margin: 0;\r\n}\r\n</style>","import script from \"./AdminNewsletter.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AdminNewsletter.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AdminNewsletter.vue?vue&type=style&index=0&id=423fd63e&scoped=true&lang=css\"\n\nimport exportComponent from \"S:\\\\Projects\\\\kino-cms\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-423fd63e\"]])\n\nexport default __exports__"],"names":["exports","sfc","props","target","__vccOpts","key","val","useNewsletterStore","defineStore","id","state","loading","showModal","smsUsers","emailUsers","templateList","smsPicked","emailPicked","templatePicked","actions","async","this","templatesFile","ref","storage","templatesData","getDocs","collection","db","forEach","doc","push","length","name","uploaded","file","fileName","data","listAll","then","res","items","itemRef","console","log","catch","error","deleteDoc","delRef","deleteObject","splice","i","templatesRef","uploadBytes","e","setDoc","useUsersStore","usersList","usersData","email","password","username","registrationDate","fullName","phone","creditCard","birthday","city","address","gender","language","emailChange","passwordChange","passwordCheck","Date","seconds","auth","getAuth","secondaryApp","signInWithEmailAndPassword","userCredential","user","deleteUser","updateEmail","updatePassword","userData","class","_createElementVNode","_createElementBlock","onClick","_ctx","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","__exports__","render","usersStore","newsletterStore","getUsers","getTemplates","smsCount","computed","smsContent","characterCount","value","smsSent","smsPercentage","smsDisabled","sendSms","Math","ceil","Promise","r","setTimeout","templateSelected","input","files","deleteTemplate","now","templateID","toggleModal","templateName","template","emailCount","emailSent","emailPercentage","sendEmail","uploadTemplates"],"sourceRoot":""}