"use strict";(self["webpackChunkkino_cms"]=self["webpackChunkkino_cms"]||[]).push([[508],{89:function(e,t){t.Z=(e,t)=>{const a=e.__vccOpts||e;for(const[i,l]of t)a[i]=l;return a}},4974:function(e,t,a){a.d(t,{V:function(){return o}});a(7658);var i=a(1020),l=a(7329),s=a(36),n=a(1294);const o=(0,i.Q_)({id:"Specials",state:()=>({loading:!1,offerList:[],showModal:!1,uploaded:!1}),actions:{async getOffers(){this.loading=!0,this.offerList=[];const e=await(0,s.PL)((0,s.hJ)(l.db,"specials"));e.forEach((e=>{this.offerList.push({id:this.offerList.length,name:e.id,uploaded:!0,creationDate:e.data().creationDate,status:e.data().status,language:e.data().language,data:e.data().data,images:[{main:{name:e.data().data[0].main.name,image:null,url:e.data().data[0].main.url,uploaded:!0},gallery:[],deleted:[]},{main:{name:e.data().data[1].main.name,image:null,url:e.data().data[1].main.url,uploaded:!0},gallery:[],deleted:[]}]})})),this.offerList.forEach((e=>{for(let t=0;t<e.data.length;t++){for(let a=0;a<e.data[t].gallery.length;a++)e.images[t].gallery.push({id:e.images[t].gallery.length,name:e.data[t].gallery[a].name,uploaded:!0,image:null,url:e.data[t].gallery[a].url});"object"===typeof e.data[t].publicationDate&&(e.data[t].publicationDate=new Date(1e3*e.data[t].publicationDate.seconds))}})),this.loading=!1},async deleteOffer(e){if(this.showModal=!1,this.loading=!0,this.offerList[e].uploaded){await(0,s.oe)((0,s.JU)(l.db,"specials",this.offerList[e].name));for(let t=0;t<this.offerList[e].images.length;t++){if(null!==this.offerList[e].images[t].main.name){const a=(0,n.iH)(l.tO,"specials/main/"+this.offerList[e].images[t].main.name);await(0,n.oq)(a).catch((e=>{console.error(e)}))}if(0!==this.offerList[e].images[t].gallery.length)for(let a=0;a<this.offerList[e].images[t].gallery.length;a++){const i=(0,n.iH)(l.tO,"specials/gallery/"+this.offerList[e].images[t].gallery[a].name);await(0,n.oq)(i).catch((e=>{console.error(e)}))}if(0!==this.offerList[e].images[t].deleted.length)for(let a=0;a<this.offerList[e].images[t].deleted.length;a++){const i=(0,n.iH)(l.tO,"specials/gallery/"+this.offerList[e].images[t].deleted[a].name);await(0,n.oq)(i).catch((e=>{console.error(e)}))}}}this.offerList.splice(e,1);for(let t=0;t<this.offerList.length;t++)this.offerList[t].id!==t&&(this.offerList[t].id=t);this.loading=!1},async uploadOffer(e){this.loading=!0,this.uploaded=!1;for(let a=0;a<this.offerList[e].images.length;a++){if(null!==this.offerList[e].images[a].main.image)try{const t=(0,n.iH)(l.tO,"specials/main/"+this.offerList[e].images[a].main.name);await(0,n.KV)(t,this.offerList[e].images[a].main.image).then((async()=>{await(0,n.Jt)(t).then((t=>{this.offerList[e].data[a].main.url=t}))}))}catch(t){console.error("Error uploading image: ",t)}if(0!==this.offerList[e].images[a].deleted.length)for(let t=0;t<this.offerList[e].images[a].deleted.length;t++){const i=(0,n.iH)(l.tO,"specials/gallery/"+this.offerList[e].images[a].deleted[t]);await(0,n.oq)(i).then((()=>{this.offerList[e].images[a].deleted.splice(t,1)})).catch((e=>{console.error(e)}))}for(let i=0;i<this.offerList[e].images[a].gallery.length;i++)if(null!==this.offerList[e].images[a].gallery[i].image)try{const t=(0,n.iH)(l.tO,"specials/gallery/"+this.offerList[e].images[a].gallery[i].name);await(0,n.KV)(t,this.offerList[e].images[a].gallery[i].image).then((async()=>{await(0,n.Jt)(t).then((t=>{this.offerList[e].data[a].gallery[i].url=t}))}))}catch(t){console.error("Error uploading image: ",t)}}},async uploadOfferData(e){const t={creationDate:this.offerList[e].creationDate,status:this.offerList[e].status,language:this.offerList[e].language,data:this.offerList[e].data};await(0,s.pl)((0,s.JU)(l.db,"specials",this.offerList[e].name),t).then((()=>{this.loading=!1,this.uploaded=!0}))}}})},6611:function(e,t,a){a.d(t,{Z:function(){return _}});var i=a(3396);const l=e=>((0,i.dD)("data-v-72d8384d"),e=e(),(0,i.Cn)(),e),s={class:"gallery"},n=["src"],o=["onClick"],r=(0,i.uE)('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" data-v-72d8384d><g transform="scale(1.5)" data-v-72d8384d><circle style="fill:#f44336;" cx="8" cy="8" r="7" data-v-72d8384d></circle><rect style="fill:#ffffff;" width="2" height="10" x="-.98" y="-16.29" transform="rotate(135)" data-v-72d8384d></rect><rect style="fill:#ffffff;" width="2" height="10" x="-12.29" y="-5.01" transform="rotate(-135)" data-v-72d8384d></rect></g></svg>',1),d=[r],f={class:"gallery__add"},g=l((()=>(0,i._)("span",null,[(0,i._)("svg",{width:"40px",height:"40px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,i._)("path",{d:"M8 12H16",stroke:"#292D32","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,i._)("path",{d:"M12 16V8",stroke:"#292D32","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,i._)("path",{d:"M9 22H15C20 22 22 20 22 15V9C22 4 20 2 15 2H9C4 2 2 4 2 9V15C2 20 4 22 9 22Z",stroke:"#292D32","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})])],-1))),u={name:"ImageGallery"};var c=Object.assign(u,{props:["gallery"],emits:["getImage","deleteImage"],setup(e,{emit:t}){function a(e){let a=e.target.files;for(let i=0;i<a.length;i++)t("getImage",a[i])}return(l,r)=>((0,i.wg)(),(0,i.iD)("div",s,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.gallery,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"gallery__item",key:e.id},[(0,i._)("img",{class:"gallery__item-preview",src:e.url,alt:""},null,8,n),(0,i._)("div",{class:"gallery__item-delete",onClick:a=>t("deleteImage",e.id)},d,8,o)])))),128)),(0,i._)("label",f,[g,(0,i._)("input",{class:"gallery__input",type:"file",multiple:"multiple",accept:"image/*",onChange:r[0]||(r[0]=e=>a(e))},null,32)])]))}}),m=a(89);const p=(0,m.Z)(c,[["__scopeId","data-v-72d8384d"]]);var _=p},1266:function(e,t,a){a.d(t,{Z:function(){return u}});var i=a(3396),l=a(7025);const s={class:"image"},n={key:0,class:"image__preview",src:l,alt:""},o=["src"],r={name:"ImageInput"};var d=Object.assign(r,{props:["input"],emits:["getImage"],setup(e,{emit:t}){function a(e){if(e){let a=e.target.files[0];t("getImage",a)}}return(t,l)=>((0,i.wg)(),(0,i.iD)("label",s,[null===e.input.url?((0,i.wg)(),(0,i.iD)("img",n)):((0,i.wg)(),(0,i.iD)("img",{key:1,class:"image__preview",src:e.input.url,alt:""},null,8,o)),(0,i._)("input",{type:"file",class:"image__input",accept:"image/*",onChange:l[0]||(l[0]=e=>a(e))},null,32)]))}}),f=a(89);const g=(0,f.Z)(d,[["__scopeId","data-v-0596ccba"]]);var u=g},346:function(e,t,a){a.d(t,{Z:function(){return x}});var i=a(3396);const l=e=>((0,i.dD)("data-v-ca697e0a"),e=e(),(0,i.Cn)(),e),s={class:"seo"},n=l((()=>(0,i._)("p",null,"SEO",-1))),o={class:"seo__content"},r={class:"seo__content-item"},d=l((()=>(0,i._)("p",null,"URL",-1))),f=["value"],g={class:"seo__content-item"},u=l((()=>(0,i._)("p",null,"Title",-1))),c=["value"],m={class:"seo__content-item"},p=l((()=>(0,i._)("p",null,"Keywords",-1))),_=["value"],h={class:"seo__content-item"},L=l((()=>(0,i._)("p",null,"Description",-1))),v=["value"],y={name:"SeoInputs"};var U=Object.assign(y,{props:["url","title","keywords","description"],setup(e){return(t,a)=>((0,i.wg)(),(0,i.iD)("div",s,[n,(0,i._)("div",o,[(0,i._)("div",r,[d,(0,i._)("input",{class:"form-control",type:"text",placeholder:"URL",value:e.url,onInput:a[0]||(a[0]=e=>t.$emit("update:url",e.target.value))},null,40,f)]),(0,i._)("div",g,[u,(0,i._)("input",{class:"form-control",type:"text",placeholder:"Title",value:e.title,onInput:a[1]||(a[1]=e=>t.$emit("update:title",e.target.value))},null,40,c)]),(0,i._)("div",m,[p,(0,i._)("input",{class:"form-control",type:"text",placeholder:"Keywords",value:e.keywords,onInput:a[2]||(a[2]=e=>t.$emit("update:keywords",e.target.value))},null,40,_)]),(0,i._)("div",h,[L,(0,i._)("textarea",{class:"form-control",placeholder:"Description",value:e.description,onInput:a[3]||(a[3]=e=>t.$emit("update:description",e.target.value))},null,40,v)])])]))}}),w=a(89);const S=(0,w.Z)(U,[["__scopeId","data-v-ca697e0a"]]);var x=S},4283:function(e,t,a){a.d(t,{Z:function(){return u}});var i=a(3396);const l=e=>((0,i.dD)("data-v-60e77b62"),e=e(),(0,i.Cn)(),e),s={class:"loading"},n=l((()=>(0,i._)("span",null,null,-1))),o=[n];function r(e,t,a,l,n,r){return(0,i.wg)(),(0,i.iD)("div",s,o)}var d={name:"TheLoading"},f=a(89);const g=(0,f.Z)(d,[["render",r],["__scopeId","data-v-60e77b62"]]);var u=g},8504:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});a(7658);var i=a(3396),l=a(4870),s=a(9242),n=a(7139),o=a(9024),r=a(4283),d=a(1266),f=a(6611),g=a(346),u=a(4974),c=a(2483);const m=e=>((0,i.dD)("data-v-8af476b6"),e=e(),(0,i.Cn)(),e),p={class:"offer"},_={class:"offer__controls"},h={class:"offer__status"},L={for:"checkbox"},v={class:"offer__languages"},y={class:"offer__languages-radio"},U=m((()=>(0,i._)("label",{for:"en"},"en",-1))),w={class:"offer__languages-radio"},S=m((()=>(0,i._)("label",{for:"ua"},"ua",-1))),x={class:"offer__wrapper"},k={class:"offer__content"},b={class:"offer__content-top"},D={class:"offer__content-item"},I=m((()=>(0,i._)("p",null,"Title",-1))),O={class:"offer__content-item"},V=m((()=>(0,i._)("p",null,"Publication date",-1))),C={class:"offer__content-item"},Z=m((()=>(0,i._)("p",null,"Description",-1))),M={class:"offer__content-item"},j=m((()=>(0,i._)("p",null,"Main image",-1))),H={class:"offer__content-item"},R=m((()=>(0,i._)("p",null,"Gallery",-1))),T={class:"offer__content-item"},E=m((()=>(0,i._)("p",null,"Video link",-1))),J={class:"offer__content-item"},K={name:"AdminSpecialOffer"};var W=Object.assign(K,{props:["id","parent"],setup(e){const t=e,a=(0,c.tv)(),m=(0,u.V)();function K(e){let a=m.offerList[t.id].language.index;m.offerList[t.id].data[a].main.name=m.offerList[t.id].images[a].main.name=0===a?m.offerList[t.id].name+"-en":m.offerList[t.id].name+"-ua",m.offerList[t.id].images[a].main.image=e,m.offerList[t.id].images[a].main.url=URL.createObjectURL(e),m.offerList[t.id].images[a].main.uploaded=!1}function W(e){let a=m.offerList[t.id].language.index,i=m.offerList[t.id].data[a].gallery.length;0===a?m.offerList[t.id].data[a].gallery.push({id:i,name:m.offerList[t.id].name+"-"+Date.now()+"-en",url:null}):m.offerList[t.id].data[a].gallery.push({id:i,name:m.offerList[t.id].name+"-"+Date.now()+"-ua",url:null}),m.offerList[t.id].images[a].gallery.push({id:i,name:m.offerList[t.id].data[a].gallery[i].name,uploaded:!1,image:e,url:URL.createObjectURL(e)})}function q(e){let a=m.offerList[t.id].language.index;m.offerList[t.id].images[a].gallery[e].uploaded&&m.offerList[t.id].images[a].deleted.push(m.offerList[t.id].images[a].gallery[e].name),m.offerList[t.id].data[a].gallery.splice(e,1),m.offerList[t.id].images[a].gallery.splice(e,1);for(let i=0;i<m.offerList[t.id].images[a].gallery.length;i++)m.offerList[t.id].images[a].gallery[i].id!==i&&(m.offerList[t.id].data[a].gallery[i].id=m.offerList[t.id].images[a].gallery[i].id=i)}function G(e){m.uploadOffer(e).then((()=>{m.uploadOfferData(e)}))}return(0,i.YP)((()=>m.offerList[t.id].language.selected),(()=>{"en"===m.offerList[t.id].language.selected?m.offerList[t.id].language.index=0:m.offerList[t.id].language.index=1})),(0,i.YP)((()=>m.uploaded),(e=>{e&&a.go(-1)})),(t,a)=>((0,i.wg)(),(0,i.iD)("div",p,[(0,i.wy)((0,i.Wm)((0,l.SU)(r.Z),null,null,512),[[s.vShow,(0,l.SU)(m).loading]]),(0,i._)("div",_,[(0,i._)("div",h,[(0,i.Uk)(" Status: "),(0,i.wy)((0,i._)("input",{type:"checkbox",id:"checkbox","onUpdate:modelValue":a[0]||(a[0]=t=>(0,l.SU)(m).offerList[e.id].status=t)},null,512),[[s.vModelCheckbox,(0,l.SU)(m).offerList[e.id].status]]),(0,i._)("label",L,(0,n.zw)((0,l.SU)(m).offerList[e.id].status),1)]),(0,i._)("div",v,[(0,i._)("div",y,[(0,i.wy)((0,i._)("input",{type:"radio",id:"en",value:"en","onUpdate:modelValue":a[1]||(a[1]=t=>(0,l.SU)(m).offerList[e.id].language.selected=t)},null,512),[[s.vModelRadio,(0,l.SU)(m).offerList[e.id].language.selected]]),U]),(0,i._)("div",w,[(0,i.wy)((0,i._)("input",{type:"radio",id:"ua",value:"ua","onUpdate:modelValue":a[2]||(a[2]=t=>(0,l.SU)(m).offerList[e.id].language.selected=t)},null,512),[[s.vModelRadio,(0,l.SU)(m).offerList[e.id].language.selected]]),S])])]),(0,i._)("div",x,[(0,i._)("div",k,[(0,i._)("div",b,[(0,i._)("div",D,[I,(0,i.wy)((0,i._)("input",{class:"form-control",type:"text",placeholder:"Title","onUpdate:modelValue":a[3]||(a[3]=t=>(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].title=t)},null,512),[[s.vModelText,(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].title]])]),(0,i._)("div",O,[V,(0,i.Wm)((0,l.SU)(o.Z),{modelValue:(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].publicationDate,"onUpdate:modelValue":a[4]||(a[4]=t=>(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].publicationDate=t),"close-on-scroll":""},null,8,["modelValue"])])]),(0,i._)("div",C,[Z,(0,i.wy)((0,i._)("textarea",{class:"form-control",placeholder:"Description","onUpdate:modelValue":a[5]||(a[5]=t=>(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].description=t)},null,512),[[s.vModelText,(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].description]])]),(0,i._)("div",M,[j,(0,i.Wm)((0,l.SU)(d.Z),{input:(0,l.SU)(m).offerList[e.id].images[(0,l.SU)(m).offerList[e.id].language.index].main,onGetImage:K},null,8,["input"])]),(0,i._)("div",H,[R,(0,i.Wm)((0,l.SU)(f.Z),{gallery:(0,l.SU)(m).offerList[e.id].images[(0,l.SU)(m).offerList[e.id].language.index].gallery,onGetImage:W,onDeleteImage:q},null,8,["gallery"])]),(0,i._)("div",T,[E,(0,i.wy)((0,i._)("input",{class:"form-control",type:"text",placeholder:"Link","onUpdate:modelValue":a[6]||(a[6]=t=>(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].videoLink=t)},null,512),[[s.vModelText,(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].videoLink]])]),(0,i._)("div",J,[(0,i.Wm)((0,l.SU)(g.Z),{url:(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].seo.url,"onUpdate:url":a[7]||(a[7]=t=>(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].seo.url=t),title:(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].seo.title,"onUpdate:title":a[8]||(a[8]=t=>(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].seo.title=t),keywords:(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].seo.keywords,"onUpdate:keywords":a[9]||(a[9]=t=>(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].seo.keywords=t),description:(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].seo.description,"onUpdate:description":a[10]||(a[10]=t=>(0,l.SU)(m).offerList[e.id].data[(0,l.SU)(m).offerList[e.id].language.index].seo.description=t)},null,8,["url","title","keywords","description"])])])]),(0,i._)("button",{class:"btn btn-primary",onClick:a[11]||(a[11]=t=>G(e.id))},"Save")]))}}),q=a(89);const G=(0,q.Z)(W,[["__scopeId","data-v-8af476b6"]]);var P=G},7025:function(e,t,a){e.exports=a.p+"img/image-icon.f1ff6c83.png"}}]);
//# sourceMappingURL=offer.9f6aa55d.js.map